!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).just={})}(this,function(t){"use strict"
var i,r,a,o=[]
function n(t){-1===o.indexOf(t)&&o.push(t),a||(a=requestAnimationFrame(s))}function s(){for(var t=performance.now(),e=0;e<o.length;e++){o[e](t)||(o.splice(e,1),e--)}if(a=o.length?requestAnimationFrame(s):0,r){var n=r
i=r=0,n()}}function A(t,e,n){return Math.min(Math.max(t,e),n)}var R,j=1e3/60,w=[],F=[]
function u(t){var e=A(t-R,0,2*j)
R=t
for(var n=w.slice(),i=0,r=n;i<r.length;i++){q(S=r[i])}for(var a=0,o=n;a<o.length;a++){E(e,S=o[a])}for(var s=0,u=n;s<u.length;s++){"cancel"===(S=u[s]).playState?S.playState="idle":"finish"===S.playState&&(S.playState="paused")}for(var p=[],h=0,f=n;h<f.length;h++){for(var l=0,c=(S=f[h]).events;l<c.length;l++){var y=c[l]
if(S.listeners){var v=S.listeners[y]
v&&v.length&&Array.prototype.push.apply(p,v)}}S.events.length=0}for(var d=[],g=0,m=n;g<m.length;g++)for(var S=m[g],b=0,_=F;b<_.length;b++){(0,_[b])(S,d)}for(var k=w.length-1;-1<k;k--)"running"!==n[k].playState&&w.splice(k,1)
for(var x=0,T=d;x<T.length;x++){(0,T[x])()}for(var O=0,P=p;O<P.length;O++){(0,P[O])(t)}return!!w.length}function q(t){if("running"===t.playState){var e=t.playbackRate<0,n=t.duration*t.iterations;(e&&t.currentTime<=1||!e&&t.currentTime>=n-1)&&(t.playState="finish",t.events.push("finish"))}}function E(t,e){e.iterations=A(e.iterations,1,86400*7)
var n=e.duration*e.iterations
"cancel"===e.playState?(e.currentTime=0,e.playbackRate=1):"finish"===e.playState?e.currentTime=e.playbackRate<0?0:n:"running"===e.playState&&(e.currentTime+=t*e.playbackRate),e.currentTime=A(e.currentTime,0,n)}var p=0,e=function(){function e(t){if(!(this instanceof e))return new e(t)
this.id="_"+ ++p,this.alternate=!1,this.currentTime=0,this.events=[],this.iterations=1,this.keyframes={},this.labels={},this.listeners={},this.playState="running",this.playbackRate=1,this.timelines_=[],t&&this.configure(t),this.id.indexOf("_")}return Object.defineProperty(e.prototype,"duration",{get:function(){for(var t=0,e=0,n=this.timelines_;e<n.length;e++){var i=n[e],r=i.animation.duration+i.pos
t<r&&(t=r)}for(var a in this.keyframes){var o=this.keyframes[a]
for(var s in o)for(var u in o[s])t<+u&&(t=+u)}return t},enumerable:!0,configurable:!0}),e.prototype.add=function(t,e){e=e||{}
var n=this.getPosition_(e.$from)
return null==n&&(n=this.duration),this.timelines_.push({animation:t,pos:n}),this.update()},e.prototype.cancel=function(){return this.playState="cancel",this.events.push("cancel"),this.update()},e.prototype.configure=function(t){for(var e in t)"function"!=typeof this[e]&&"duration"!==e&&(this[e]=t[e])
return this.update(),this},e.prototype.finish=function(){return this.playState="finish",this.events.push("finish"),this.update()},e.prototype.getConfig=function(){var t={}
for(var e in this)if("_"!==e[e.length-1]){var n=this[e]
"function"!=typeof n&&(t[e]=n)}return t},e.prototype.getEventGroup_=function(t){var e=this.listeners[t]
return e||(e=this.listeners[t]=[]),e},e.prototype.getPosition_=function(t){return t&&"number"!=typeof t&&(t=this.labels[t]),t},e.prototype.label=function(t,e){return this.labels[t]=void 0===e?this.duration:e,this},e.prototype.off=function(t,e){var n=this.getEventGroup_(t),i=n.indexOf(e)
return-1!==i&&n.splice(i,1),this},e.prototype.on=function(t,e){var n=this.getEventGroup_(t)
return-1===n.indexOf(e)&&n.push(e),this},e.prototype.pause=function(){return this.playState="paused",this.events.push("pause"),this.update()},e.prototype.play=function(){return this.playState="running",this.events.push("play"),this.update()},e.prototype.seek=function(t){return((t=this.getPosition_(t))||0===t)&&(this.currentTime=t),"running"!==this.playState?this.pause():this.update()},e.prototype.update=function(){var t
return t=this,w.length||(R=performance.now(),n(u)),-1===w.indexOf(t)&&w.push(t),this},e}()
F.push(function(t,e){}),t.nextAnimationFrame=function(){return i||(i=new Promise(function(t){r=t})),a||(a=requestAnimationFrame(s)),i},t.Timeline=e,t.tick=n,Object.defineProperty(t,"__esModule",{value:!0})})
